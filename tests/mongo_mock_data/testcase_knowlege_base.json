[{"_id":{"$oid":"67e10e8da6aeb9c974b64085"},"mitreid":"T1087.002","mdtext":"<details>\n<summary>Domain User Enumeration</summary>\n<div class=\"tabbed-set\" data-tabs=\"1:3\"><input checked=\"checked\" id=\"__tabbed_1_1\" name=\"__tabbed_1\" type=\"radio\" /><label for=\"__tabbed_1_1\">SMB/SAMR</label><div class=\"tabbed-content\">\n<div class=\"highlight\"><span class=\"filename\">Net Commands</span><pre><span></span><code>net<span class=\"w\"> </span>user<span class=\"w\"> </span><span class=\"o\">{{</span>TARGET_DOMAIN_USER<span class=\"o\">}}</span><span class=\"w\"> </span>/domain<span class=\"w\"> </span>\n</code></pre></div>\n</div>\n<input id=\"__tabbed_1_2\" name=\"__tabbed_1\" type=\"radio\" /><label for=\"__tabbed_1_2\">LDAP</label><div class=\"tabbed-content\">\n<div class=\"highlight\"><span class=\"filename\">pyldapsearch</span><pre><span></span><code>pyldapsearch<span class=\"w\"> </span><span class=\"s1\">&#39;{{DOMAIN_NAME}}/{{LOWPRIVILEGED_DOMAIN_USER}}:{{LOWPRIVILEGED_DOMAIN_USER_PASSWORD}}&#39;</span><span class=\"w\"> </span><span class=\"s1\">&#39;(samAccountName={{TARGET_DOMAIN_USER}})&#39;</span><span class=\"w\"> </span>-attributes<span class=\"w\"> </span>memberOf<span class=\"w\"> </span>-dc-ip<span class=\"w\"> </span><span class=\"o\">{{</span>DC_IP<span class=\"o\">}}</span>\n</code></pre></div>\n</div>\n<input id=\"__tabbed_1_3\" name=\"__tabbed_1\" type=\"radio\" /><label for=\"__tabbed_1_3\">LDAPS</label><div class=\"tabbed-content\">\n<div class=\"highlight\"><span class=\"filename\">pyldapsearch</span><pre><span></span><code>pyldapsearch<span class=\"w\"> </span><span class=\"s1\">&#39;{{DOMAIN_NAME}}/{{LOWPRIVILEGED_DOMAIN_USER}}:{{LOWPRIVILEGED_DOMAIN_USER_PASSWORD}}&#39;</span><span class=\"w\"> </span><span class=\"s1\">&#39;(samAccountName={{TARGET_DOMAIN_USER}})&#39;</span><span class=\"w\"> </span>-attributes<span class=\"w\"> </span>memberOf<span class=\"w\"> </span>-dc-ip<span class=\"w\"> </span><span class=\"o\">{{</span>DC_IP<span class=\"o\">}}</span><span class=\"w\"> </span>-ldaps\n</code></pre></div>\n</div>\n</div>\n</details>\n<details>\n<summary>Privileged Domain User Enumeration</summary>\n<div class=\"tabbed-set\" data-tabs=\"2:2\"><input checked=\"checked\" id=\"__tabbed_2_1\" name=\"__tabbed_2\" type=\"radio\" /><label for=\"__tabbed_2_1\">LDAP</label><div class=\"tabbed-content\">\n<div class=\"highlight\"><span class=\"filename\">pyldapsearch</span><pre><span></span><code>pyldapsearch<span class=\"w\"> </span><span class=\"s1\">&#39;{{DOMAIN_NAME}}/{{LOWPRIVILEGED_DOMAIN_USER}}:{{LOWPRIVILEGED_DOMAIN_USER_PASSWORD}}&#39;</span><span class=\"w\"> </span><span class=\"s1\">&#39;(Name={{DOMAIN_ADMIN}})&#39;</span><span class=\"w\"> </span>-dc-ip<span class=\"w\"> </span><span class=\"o\">{{</span>DC_IP<span class=\"o\">}}</span><span class=\"w\"> </span>\n</code></pre></div>\n</div>\n<input id=\"__tabbed_2_2\" name=\"__tabbed_2\" type=\"radio\" /><label for=\"__tabbed_2_2\">LDAPS</label><div class=\"tabbed-content\">\n<div class=\"highlight\"><span class=\"filename\">pyldapsearch</span><pre><span></span><code>pyldapsearch<span class=\"w\"> </span><span class=\"s1\">&#39;{{DOMAIN_NAME}}/{{LOWPRIVILEGED_DOMAIN_USER}}:{{LOWPRIVILEGED_DOMAIN_USER_PASSWORD}}&#39;</span><span class=\"w\"> </span><span class=\"s1\">&#39;(Name={{DOMAIN_ADMIN}})&#39;</span><span class=\"w\"> </span>-dc-ip<span class=\"w\"> </span><span class=\"o\">{{</span>DC_IP<span class=\"o\">}}</span><span class=\"w\"> </span>-ldaps\n</code></pre></div>\n</div>\n</div>\n</details>\n<details>\n<summary>Mass Domain User Enumeration</summary>\n<div class=\"tabbed-set\" data-tabs=\"3:3\"><input checked=\"checked\" id=\"__tabbed_3_1\" name=\"__tabbed_3\" type=\"radio\" /><label for=\"__tabbed_3_1\">LDAP</label><div class=\"tabbed-content\">\n<p><div class=\"highlight\"><span class=\"filename\">pyldapsearch - Query all attributes for all user objects</span><pre><span></span><code>pyldapsearch<span class=\"w\"> </span><span class=\"s1\">&#39;{{DOMAIN_NAME}}/{{LOWPRIVILEGED_DOMAIN_USER}}:{{LOWPRIVILEGED_DOMAIN_USER_PASSWORD}}&#39;</span><span class=\"w\"> </span><span class=\"s1\">&#39;(objectClass=user)&#39;</span><span class=\"w\"> </span>-dc-ip<span class=\"w\"> </span><span class=\"o\">{{</span>DC_IP<span class=\"o\">}}</span><span class=\"w\"> </span>\n</code></pre></div><br />\n<div class=\"highlight\"><span class=\"filename\">sharphound - DCOnly</span><pre><span></span><code>runas.exe<span class=\"w\"> </span>/netonly<span class=\"w\"> </span>/user:<span class=\"o\">{{</span>DOMAIN_NAME<span class=\"o\">}}</span><span class=\"se\">\\{</span><span class=\"o\">{</span>LOWPRIVILEGED_DOMAIN_USER<span class=\"o\">}}</span><span class=\"w\"> </span>cmd.exe\nsharphound.exe<span class=\"w\"> </span>--dc<span class=\"w\"> </span><span class=\"o\">{{</span>DC_IP<span class=\"o\">}}</span><span class=\"w\"> </span>--domain<span class=\"w\"> </span>-c<span class=\"w\"> </span>DCOnly\n</code></pre></div></p>\n</div>\n<input id=\"__tabbed_3_2\" name=\"__tabbed_3\" type=\"radio\" /><label for=\"__tabbed_3_2\">LDAPS</label><div class=\"tabbed-content\">\n<div class=\"highlight\"><span class=\"filename\">pyldapsearch - Query all attributes for all user objects</span><pre><span></span><code>pyldapsearch<span class=\"w\"> </span><span class=\"s1\">&#39;{{DOMAIN_NAME}}/{{LOWPRIVILEGED_DOMAIN_USER}}:{{LOWPRIVILEGED_DOMAIN_USER_PASSWORD}}&#39;</span><span class=\"w\"> </span><span class=\"s1\">&#39;(objectClass=user)&#39;</span><span class=\"w\"> </span>-dc-ip<span class=\"w\"> </span><span class=\"o\">{{</span>DC_IP<span class=\"o\">}}</span><span class=\"w\"> </span>-ldaps\n</code></pre></div>\n</div>\n<input id=\"__tabbed_3_3\" name=\"__tabbed_3\" type=\"radio\" /><label for=\"__tabbed_3_3\">SOAP</label><div class=\"tabbed-content\">\n<div class=\"highlight\"><span class=\"filename\">SOAPHound</span><pre><span></span><code>runas.exe<span class=\"w\"> </span>/netonly<span class=\"w\"> </span>/user:<span class=\"o\">{{</span>DOMAIN_NAME<span class=\"o\">}}</span><span class=\"se\">\\{</span><span class=\"o\">{</span>LOWPRIVILEGED_DOMAIN_USER<span class=\"o\">}}</span><span class=\"w\"> </span>cmd.exe\nSOAPHound.exe<span class=\"w\"> </span>--dc<span class=\"w\"> </span><span class=\"o\">{{</span>DC_IP<span class=\"o\">}}</span><span class=\"w\"> </span>--buildcache<span class=\"w\"> </span>--bhdump<span class=\"w\"> </span>--outputdirectory<span class=\"w\"> </span>C:<span class=\"se\">\\t</span>emp<span class=\"se\">\\s</span>oaphound.output<span class=\"w\"> </span>--cachefilename<span class=\"w\"> </span>C:<span class=\"se\">\\t</span>emp<span class=\"se\">\\s</span>oaphound.cache<span class=\"w\"> </span>--domain<span class=\"w\"> </span><span class=\"o\">{{</span>DOMAIN_NAME<span class=\"o\">}}</span>\n</code></pre></div>\n</div>\n</div>\n</details>"}]
